<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>VIM: textprop</title>
<link rel="stylesheet" href="vim-stylesheet.css" type="text/css">
</head>
<body>
<h2>TEXTPROP</h2>
<pre>
<b class="vimtag">*<a name="textprop.txt">textprop.txt</a>*</b>  For Vim version 8.1.  Last change: 2019 Jan 08


		  VIM REFERENCE MANUAL    by Bram Moolenaar


Displaying text with properties attached.		<b class="vimtag">*<a name="text-properties">text-properties</a>*</b>

THIS IS UNDER DEVELOPMENT - ANYTHING MAY STILL CHANGE  <b class="vimtag">*<a name="E967">E967</a>*</b>

What is not working yet:
- Adjusting column/length when inserting text
- Text properties spanning more than one line
- prop_find()
- callbacks when text properties are outdated


1. Introduction			|<a href="textprop.html#text-prop-intro">text-prop-intro</a>|
2. Functions			|<a href="textprop.html#text-prop-functions">text-prop-functions</a>|
3. When text changes		|<a href="textprop.html#text-prop-changes">text-prop-changes</a>|


<code class="special">{Vi does not have text properties}</code>
{not able to use text properties when the |<a href="various.html#+textprop">+textprop</a>| feature was
disabled at compile time}

</pre><hr><pre>1. Introduction						<b class="vimtag">*<a name="text-prop-intro">text-prop-intro</a>*</b>

Text properties can be attached to text in a buffer.  They will move with the
text: If lines are deleted or inserted the properties move with the text they
are attached to.  Also when inserting/deleting text in the line before the
text property.  And when inserting/deleting text inside the text property, it
will increase/decrease in size.

The main use for text properties is to highlight text.  This can be seen as a
replacement for syntax highlighting.  Instead of defining patterns to match
the text, the highlighting is set by a script, possibly using the output of an
external parser.  This only needs to be done once, not every time when
redrawing the screen, thus can be much faster, after the initial cost of
attaching the text properties.

Text properties can also be used for other purposes to identify text.  For
example, add a text property on a function name, so that a search can be
defined to jump to the next/previous function.

A text property is attached at a specific line and column, and has a specified
length.  The property can span multiple lines.

A text property has these fields:
	"id"		a number to be used as desired
	"type"		the name of a property type


<code class="section">Property Types </code>
							<b class="vimtag">*<a name="E971">E971</a>*</b>
A text property normally has the name of a property type, which defines
how to highlight the text.  The property type can have these entries:
	"highlight"	name of the highlight group to use
	"priority"	when properties overlap, the one with the highest
			priority will be used.
	"start_incl"	when TRUE inserts at the start position will be
			included in the text property
	"end_incl"    	when TRUE inserts at the end position will be
			included in the text property


<code class="section">Example </code>

Suppose line 11 in a buffer has this text (excluding the indent):

	The number 123 is smaller than 4567.

To highlight the numbers in this text:
<code class="example">	call prop_type_add('number', <code class="special">{'highlight': 'Constant'}</code>)</code>
<code class="example">	call prop_add(11, 12, <code class="special">{'length': 3, 'type': 'number'}</code>)</code>
<code class="example">	call prop_add(11, 32, <code class="special">{'length': 4, 'type': 'number'}</code>)</code>
<code class="example"></code>
Try inserting or deleting lines above the text, you will see that the text
properties stick to the text, thus the line number is adjusted as needed.

Setting "start_incl" and "end_incl" is useful when white space surrounds the
text, e.g. for a function name.  Using false is useful when the text starts
and/or ends with a specific character, such as the quote surrounding a string.

<code class="section">	func FuncName(arg) </code>
	     ^^^^^^^^        property with start_incl and end_incl set

<code class="section">	var = "text"; </code>
	      ^^^^^^	     property with start_incl and end_incl not set

Nevertheless, when text is inserted or deleted the text may need to be parsed
and the text properties updated.  But this can be done asynchronously.

</pre><hr><pre>2. Functions						<b class="vimtag">*<a name="text-prop-functions">text-prop-functions</a>*</b>

Manipulating text property types:

prop_type_add(<code class="special">{name}</code>, <code class="special">{props}</code>)		define a new property type
prop_type_change(<code class="special">{name}</code>, <code class="special">{props}</code>)	change an existing property type
prop_type_delete(<code class="special">{name}</code> [, <code class="special">{props}</code>])	delete a property type
prop_type_get([<code class="special">{name}</code> [, <code class="special">{props}</code>])	get property type values
prop_type_list([<code class="special">{props}</code>])		get list of property types


Manipulating text properties:

prop_add(<code class="special">{lnum}</code>, <code class="special">{col}</code>, <code class="special">{props}</code>)  	add a text property
prop_clear(<code class="special">{lnum}</code> [, <code class="special">{lnum-end}</code> [, <code class="special">{bufnr}</code>]])
					remove all text properties
prop_find(<code class="special">{props}</code> [, <code class="special">{direction}</code>])	search for a text property
prop_list(<code class="special">{lnum}</code> [, <code class="special">{props}</code>)  		text properties in <code class="special">{lnum}</code>
prop_remove(<code class="special">{props}</code> [, <code class="special">{lnum}</code> [, <code class="special">{lnum-end}</code>]])
					remove a text property

</pre><hr><pre>3. When text changes				<b class="vimtag">*<a name="text-prop-changes">text-prop-changes</a>*</b>

Vim will do its best to keep the text properties on the text where it was
attached.  When inserting or deleting text the properties after the change
will move accordingly.

When text is deleted and a text property no longer includes any text, it is
deleted.  However, a text property that was defined as zero-width will remain,
unless the whole line is deleted.

When using replace mode, the text properties stay on the same character
positions, even though the characters themselves change.


<code class="section">When text property columns are not updated </code>

- When setting the line with |<a href="eval.html#setline()">setline()</a>| or through an interface, such as Lua,
  Tcl or Python.


 vim:tw=78:ts=8:noet:ft=help:norl:
</pre>
<p><i>Generated by vim2html on 01 May 2019 13:47:24</i></p>
</body>
</html>
